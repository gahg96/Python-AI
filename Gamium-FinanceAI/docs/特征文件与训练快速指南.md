# ç‰¹å¾æ–‡ä»¶ä¸è®­ç»ƒå¿«é€ŸæŒ‡å—

## ğŸš€ å¿«é€Ÿå¼€å§‹

### 1. ç”Ÿæˆç¤ºä¾‹ç‰¹å¾æ–‡ä»¶

```bash
# ç”Ÿæˆ1000æ¡ç¤ºä¾‹æ•°æ®
python3 scripts/generate_sample_features.py \
    --output data/sample_features.parquet \
    --count 1000

# æˆ–ç”ŸæˆCSVæ ¼å¼ï¼ˆä¾¿äºæŸ¥çœ‹ï¼‰
python3 scripts/generate_sample_features.py \
    --output data/sample_features.csv \
    --count 1000 \
    --format csv
```

### 2. æŸ¥çœ‹ç‰¹å¾æ–‡ä»¶æ ¼å¼

```bash
# ä½¿ç”¨æˆ‘ä»¬çš„æŸ¥çœ‹å·¥å…·
python3 scripts/view_parquet.py data/sample_features.parquet --head 10

# æˆ–ä½¿ç”¨Python
python3 << EOF
import pandas as pd
features = pd.read_parquet('data/sample_features.parquet')
print(features.head())
print(f"\nç‰¹å¾ç»´åº¦: {features.shape}")
print(f"\nç‰¹å¾åˆ—è¡¨:\n{features.columns.tolist()}")
EOF
```

### 3. è®­ç»ƒæ¨¡å‹

```bash
# ä½¿ç”¨ç¤ºä¾‹ç‰¹å¾æ–‡ä»¶è®­ç»ƒ
python3 scripts/train_model.py \
    --features data/sample_features.parquet \
    --output models/

# ä½¿ç”¨å®é™…æå–çš„ç‰¹å¾æ–‡ä»¶è®­ç»ƒ
python3 scripts/train_model.py \
    --features data/extracted/customer_features.parquet \
    --output models/
```

---

## ğŸ“Š ç‰¹å¾æ–‡ä»¶æ ¼å¼è¯´æ˜

### æ–‡ä»¶ç»“æ„

ç‰¹å¾æ–‡ä»¶åŒ…å«ä»¥ä¸‹35ä¸ªå­—æ®µï¼š

#### å®¢æˆ·æ ‡è¯† (1ä¸ª)
- `customer_id`: å®¢æˆ·IDï¼ˆå·²è„±æ•ï¼‰

#### åŸºç¡€ç‰¹å¾ (6ä¸ª)
- `age`: å¹´é¾„
- `gender`: æ€§åˆ« (M/F)
- `education`: æ•™è‚²æ°´å¹³
- `industry`: è¡Œä¸š
- `city_tier`: åŸå¸‚ç­‰çº§
- `customer_type`: å®¢æˆ·ç±»å‹

#### è´¢åŠ¡ç‰¹å¾ (7ä¸ª)
- `monthly_income`: æœˆæ”¶å…¥
- `total_assets`: æ€»èµ„äº§
- `total_liabilities`: æ€»è´Ÿå€º
- `debt_ratio`: è´Ÿå€ºç‡
- `debt_to_income`: å€ºåŠ¡æ”¶å…¥æ¯”
- `total_deposit_balance`: å­˜æ¬¾ä½™é¢
- `avg_account_balance`: å¹³å‡è´¦æˆ·ä½™é¢

#### äº¤æ˜“ç‰¹å¾ (6ä¸ª)
- `total_income`: æ€»æ”¶å…¥
- `total_expense`: æ€»æ”¯å‡º
- `savings_rate`: å‚¨è“„ç‡
- `income_volatility`: æ”¶å…¥æ³¢åŠ¨ç‡
- `transaction_count`: äº¤æ˜“æ¬¡æ•°
- `avg_transaction_amount`: å¹³å‡äº¤æ˜“é‡‘é¢

#### è´·æ¬¾å†å²ç‰¹å¾ (7ä¸ª)
- `total_loans`: å†å²è´·æ¬¾æ¬¡æ•°
- `total_loan_amount`: å†å²è´·æ¬¾æ€»é¢
- `avg_loan_amount`: å¹³å‡è´·æ¬¾é‡‘é¢
- `default_count`: è¿çº¦æ¬¡æ•°
- `max_overdue_days`: æœ€å¤§é€¾æœŸå¤©æ•°
- `avg_interest_rate`: å¹³å‡åˆ©ç‡
- `months_since_last_loan`: è·ä¸Šæ¬¡è´·æ¬¾æœˆæ•°

#### æ—¶é—´ç‰¹å¾ (2ä¸ª)
- `months_as_customer`: æˆä¸ºå®¢æˆ·æœˆæ•°
- `registration_date`: æ³¨å†Œæ—¥æœŸ

#### æ ‡ç­¾ (3ä¸ª)
- `defaulted`: æ˜¯å¦è¿çº¦ (0/1)
- `default_probability`: è¿çº¦æ¦‚ç‡ (0-1)
- `loan_status`: è´·æ¬¾çŠ¶æ€

---

## ğŸ“ ç‰¹å¾æ–‡ä»¶æ ·ä¾‹

### æŸ¥çœ‹å‰5è¡Œ

```python
import pandas as pd

features = pd.read_parquet('data/sample_features.parquet')
print(features.head())
```

**è¾“å‡ºç¤ºä¾‹ï¼š**
```
   customer_id  age gender education    industry city_tier customer_type  monthly_income  total_assets  ...
0         C000   35      M  bachelor          it    tier_1     salaried        15234.56     456789.12  ...
1         C001   42      F   master     finance    tier_2 small_business        28456.78    1234567.89  ...
2         C002   28      M  bachelor manufacturing    tier_1     salaried        12345.67     345678.90  ...
3         C003   55      F high_school     service    tier_3       farmer         8234.56     234567.89  ...
4         C004   38      M    college      retail    tier_2   freelancer        18765.43     456789.01  ...
```

### ç‰¹å¾ç»Ÿè®¡ä¿¡æ¯

```python
# æ•°å€¼ç‰¹å¾ç»Ÿè®¡
print(features.select_dtypes(include=['number']).describe())

# åˆ†ç±»ç‰¹å¾ç»Ÿè®¡
print(features.select_dtypes(include=['object']).describe())
```

---

## ğŸ¯ è®­ç»ƒæµç¨‹

### å®Œæ•´è®­ç»ƒæµç¨‹

```
1. æ•°æ®åŠ è½½
   â†“
2. æ•°æ®é¢„å¤„ç†ï¼ˆç¼ºå¤±å€¼ã€ç¼–ç ï¼‰
   â†“
3. ç‰¹å¾é€‰æ‹©
   â†“
4. æ•°æ®åˆ†å‰²ï¼ˆè®­ç»ƒ/éªŒè¯/æµ‹è¯•ï¼‰
   â†“
5. ç‰¹å¾æ ‡å‡†åŒ–
   â†“
6. æ¨¡å‹è®­ç»ƒ
   â†“
7. æ¨¡å‹è¯„ä¼°
   â†“
8. æ¨¡å‹ä¿å­˜
```

### è®­ç»ƒè¾“å‡º

è®­ç»ƒå®Œæˆåä¼šç”Ÿæˆä»¥ä¸‹æ–‡ä»¶ï¼š

```
models/
â”œâ”€â”€ model_20241209_143022.pkl          # è®­ç»ƒå¥½çš„æ¨¡å‹
â”œâ”€â”€ scaler_20241209_143022.pkl         # ç‰¹å¾æ ‡å‡†åŒ–å™¨
â”œâ”€â”€ encoders_20241209_143022.pkl       # åˆ†ç±»ç‰¹å¾ç¼–ç å™¨
â””â”€â”€ model_info_20241209_143022.json    # æ¨¡å‹å…ƒä¿¡æ¯
```

### æ¨¡å‹è¯„ä¼°æŒ‡æ ‡

- **AUC Score**: è¡¡é‡æ¨¡å‹åŒºåˆ†èƒ½åŠ›ï¼ˆ0-1ï¼Œè¶Šé«˜è¶Šå¥½ï¼‰
- **Precision**: ç²¾ç¡®ç‡
- **Recall**: å¬å›ç‡
- **F1-Score**: F1åˆ†æ•°

---

## ğŸ’¡ ä½¿ç”¨ç¤ºä¾‹

### ç¤ºä¾‹1ï¼šç”Ÿæˆå¹¶æŸ¥çœ‹ç¤ºä¾‹ç‰¹å¾æ–‡ä»¶

```bash
# 1. ç”Ÿæˆç¤ºä¾‹æ–‡ä»¶
python3 scripts/generate_sample_features.py --output data/sample.parquet --count 100

# 2. æŸ¥çœ‹æ–‡ä»¶
python3 scripts/view_parquet.py data/sample.parquet --head 10

# 3. æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯
python3 scripts/view_parquet.py data/sample.parquet --stats
```

### ç¤ºä¾‹2ï¼šä½¿ç”¨å®é™…æ•°æ®è®­ç»ƒ

```bash
# 1. æå–ç‰¹å¾ï¼ˆå¦‚æœè¿˜æ²¡æœ‰ï¼‰
python3 scripts/extract_banking_data.py --config config/extract_config.yaml

# 2. è®­ç»ƒæ¨¡å‹
python3 scripts/train_model.py \
    --features data/extracted/customer_features.parquet \
    --output models/

# 3. æŸ¥çœ‹è®­ç»ƒç»“æœ
cat models/model_info_*.json | python3 -m json.tool
```

### ç¤ºä¾‹3ï¼šPythonä»£ç ä¸­ä½¿ç”¨

```python
import pandas as pd
import pickle

# åŠ è½½ç‰¹å¾æ–‡ä»¶
features = pd.read_parquet('data/sample_features.parquet')

# åŠ è½½æ¨¡å‹
with open('models/model_20241209_143022.pkl', 'rb') as f:
    model = pickle.load(f)

# åŠ è½½scaler
with open('models/scaler_20241209_143022.pkl', 'rb') as f:
    scaler = pickle.load(f)

# å‡†å¤‡ç‰¹å¾
feature_cols = ['age', 'monthly_income', 'debt_ratio', ...]
X = features[feature_cols]

# æ ‡å‡†åŒ–
X_scaled = scaler.transform(X)

# é¢„æµ‹
predictions = model.predict(X_scaled)
probabilities = model.predict_proba(X_scaled)[:, 1]

print(f"é¢„æµ‹ç»“æœ: {predictions[:10]}")
print(f"è¿çº¦æ¦‚ç‡: {probabilities[:10]}")
```

---

## ğŸ“š ç›¸å…³æ–‡æ¡£

- **è¯¦ç»†æŒ‡å—**: `docs/ç‰¹å¾æ–‡ä»¶æ ¼å¼ä¸è®­ç»ƒæŒ‡å—.md`
- **æ•°æ®æå–**: `docs/é“¶è¡Œæ•°æ®æå–ä¸ç‰¹å¾å·¥ç¨‹æŒ‡å—.md`
- **ç³»ç»Ÿæ¶æ„**: `docs/é“¶è¡Œç³»ç»Ÿæ¶æ„ä¸æ•°æ®æå–è¯¦è§£.html`

---

## âš ï¸ æ³¨æ„äº‹é¡¹

1. **æ•°æ®è´¨é‡**
   - ç¡®ä¿ç‰¹å¾æ–‡ä»¶æ²¡æœ‰ç¼ºå¤±å€¼
   - æ£€æŸ¥å¼‚å¸¸å€¼
   - éªŒè¯æ•°æ®åˆ†å¸ƒ

2. **ç‰¹å¾é€‰æ‹©**
   - æ ¹æ®ä¸šåŠ¡éœ€æ±‚é€‰æ‹©ç›¸å…³ç‰¹å¾
   - é¿å…ç‰¹å¾å†—ä½™
   - æ³¨æ„ç‰¹å¾é‡è¦æ€§

3. **æ¨¡å‹è®­ç»ƒ**
   - ä½¿ç”¨è¶³å¤Ÿçš„æ•°æ®é‡ï¼ˆå»ºè®®>10,000æ¡ï¼‰
   - æ³¨æ„ç±»åˆ«ä¸å¹³è¡¡é—®é¢˜
   - å®šæœŸé‡æ–°è®­ç»ƒæ¨¡å‹

4. **æ¨¡å‹éƒ¨ç½²**
   - ä¿å­˜æ‰€æœ‰å¿…è¦çš„é¢„å¤„ç†ç»„ä»¶ï¼ˆscalerã€encodersï¼‰
   - è®°å½•æ¨¡å‹ç‰ˆæœ¬å’Œå…ƒä¿¡æ¯
   - å»ºç«‹æ¨¡å‹ç›‘æ§æœºåˆ¶

