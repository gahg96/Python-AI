<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Gamium æ•°æ®ç”Ÿæˆæµç¨‹è¯¦è§£</title>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Serif+SC:wght@400;600;700&family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <style>
        :root {
            --primary: #0066FF;
            --accent: #00D4AA;
            --gold: #FFB800;
            --dark: #0A0E17;
            --dark-secondary: #141B2D;
            --text: #E2E8F0;
            --text-muted: #94A3B8;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            font-family: 'Inter', 'Noto Serif SC', sans-serif;
            background: var(--dark);
            color: var(--text);
            line-height: 1.8;
            padding: 40px 20px;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
        }
        
        h1 {
            font-family: 'Noto Serif SC', serif;
            font-size: 2.5rem;
            margin-bottom: 16px;
            background: linear-gradient(135deg, #0066FF 0%, #00D4AA 100%);
            -webkit-background-clip: text;
            -webkit-text-fill-color: transparent;
        }
        
        h2 {
            font-family: 'Noto Serif SC', serif;
            font-size: 1.8rem;
            margin: 48px 0 24px;
            color: var(--accent);
            border-bottom: 2px solid rgba(0, 212, 170, 0.3);
            padding-bottom: 12px;
        }
        
        h3 {
            font-size: 1.3rem;
            margin: 32px 0 16px;
            color: var(--gold);
        }
        
        .section {
            background: rgba(20, 27, 45, 0.6);
            border-radius: 16px;
            padding: 32px;
            margin-bottom: 32px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .flow-diagram {
            background: rgba(0, 102, 255, 0.1);
            border: 1px solid rgba(0, 102, 255, 0.3);
            border-radius: 12px;
            padding: 24px;
            margin: 24px 0;
        }
        
        .flow-step {
            display: flex;
            align-items: center;
            margin: 16px 0;
            padding: 16px;
            background: rgba(0,0,0,0.3);
            border-radius: 8px;
        }
        
        .step-number {
            width: 40px;
            height: 40px;
            background: linear-gradient(135deg, #0066FF, #00D4AA);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: 700;
            margin-right: 16px;
            flex-shrink: 0;
        }
        
        .step-content {
            flex: 1;
        }
        
        .step-title {
            font-weight: 600;
            margin-bottom: 4px;
        }
        
        .step-desc {
            color: var(--text-muted);
            font-size: 0.95rem;
        }
        
        .code-block {
            background: rgba(0,0,0,0.5);
            border: 1px solid rgba(255,255,255,0.1);
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
            font-family: 'JetBrains Mono', 'Courier New', monospace;
            font-size: 0.9rem;
            overflow-x: auto;
        }
        
        .highlight {
            background: rgba(255, 184, 0, 0.2);
            padding: 2px 6px;
            border-radius: 4px;
            color: var(--gold);
        }
        
        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 16px 0;
            font-size: 0.9rem;
        }
        
        .data-table th,
        .data-table td {
            padding: 12px;
            text-align: left;
            border-bottom: 1px solid rgba(255,255,255,0.1);
        }
        
        .data-table th {
            background: rgba(0, 102, 255, 0.2);
            color: var(--accent);
            font-weight: 600;
        }
        
        .formula {
            background: rgba(0, 212, 170, 0.1);
            border-left: 3px solid var(--accent);
            padding: 12px 16px;
            margin: 16px 0;
            font-family: 'JetBrains Mono', monospace;
        }
        
        .stat-box {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 16px;
            margin: 24px 0;
        }
        
        .stat-item {
            background: rgba(0,0,0,0.3);
            padding: 16px;
            border-radius: 8px;
            border: 1px solid rgba(255,255,255,0.1);
        }
        
        .stat-value {
            font-size: 1.5rem;
            font-weight: 700;
            color: var(--accent);
            margin-bottom: 4px;
        }
        
        .stat-label {
            color: var(--text-muted);
            font-size: 0.9rem;
        }
        
        .warning {
            background: rgba(255, 184, 0, 0.1);
            border: 1px solid rgba(255, 184, 0, 0.3);
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
        }
        
        .info {
            background: rgba(0, 102, 255, 0.1);
            border: 1px solid rgba(0, 102, 255, 0.3);
            border-radius: 8px;
            padding: 16px;
            margin: 16px 0;
        }
        
        ul, ol {
            margin-left: 24px;
            margin-top: 8px;
        }
        
        li {
            margin: 8px 0;
            color: var(--text-muted);
        }
        
        .back-link {
            display: inline-block;
            margin-bottom: 24px;
            color: var(--accent);
            text-decoration: none;
            font-size: 0.9rem;
        }
        
        .back-link:hover {
            text-decoration: underline;
        }
    </style>
</head>
<body>
    <div class="container">
        <div style="margin-bottom: 24px; display: flex; gap: 16px; flex-wrap: wrap;">
            <a href="/story" class="back-link">â† è¿”å›é¡¹ç›®ä»‹ç»</a>
            <a href="/" class="back-link">ğŸ“Š å¤§å±ç›‘æ§</a>
            <a href="/control" class="back-link">ğŸ® æ“ä½œæ§åˆ¶å°</a>
        </div>
        
        <h1>ğŸ“Š Gamium æ•°æ®ç”Ÿæˆæµç¨‹è¯¦è§£</h1>
        <p style="color: var(--text-muted); margin-bottom: 32px;">
            æœ¬æ–‡æ¡£è¯¦ç»†æè¿° Gamium Finance AI å¹³å°å¦‚ä½•ç”Ÿæˆå¤§è§„æ¨¡æ¨¡æ‹Ÿå†å²æ•°æ®ï¼Œ
            ä»å®¢æˆ·ç”»åƒåˆ°è´·æ¬¾ç”³è¯·ï¼Œå†åˆ°è¿˜æ¬¾è®°å½•ï¼Œå®Œæ•´è¿˜åŸé“¶è¡Œä¿¡è´·ä¸šåŠ¡çš„æ•°æ®é“¾è·¯ã€‚
        </p>
        
        <!-- å®Œæ•´æµç¨‹è¯¦è§£ -->
        <div class="section">
            <h2>ğŸ”„ æ•°æ®ç”Ÿæˆå®Œæ•´æµç¨‹</h2>
            
            <h3>é˜¶æ®µä¸€ï¼šåˆå§‹åŒ–ä¸ä»»åŠ¡åˆ†é…</h3>
            <div class="code-block">
# 1. è§£æå‘½ä»¤è¡Œå‚æ•°
python3 scripts/generate_dataset.py --target-size 10 --batch-size 30000 --workers 2

# 2. è®¡ç®—ä»»åŠ¡å‚æ•°
ç›®æ ‡å®¢æˆ·æ•° = 10GB Ã— 1,000,000 / 1.3 â‰ˆ 7,692,307 å®¢æˆ·
æ‰¹æ¬¡æ•°é‡ = 7,692,307 / 30,000 â‰ˆ 256 æ‰¹æ¬¡
å¹¶è¡Œè¿›ç¨‹ = 2 ä¸ª

# 3. åˆ›å»ºè¾“å‡ºç›®å½•
data/historical/
  â””â”€â”€ temp/  (ä¸´æ—¶æ–‡ä»¶ç›®å½•)
            </div>
            
            <h3>é˜¶æ®µäºŒï¼šå¹¶è¡Œæ‰¹æ¬¡ç”Ÿæˆ</h3>
            <p>ä½¿ç”¨ <code>ProcessPoolExecutor</code> åˆ›å»ºå¤šä¸ªå·¥ä½œè¿›ç¨‹ï¼Œæ¯ä¸ªè¿›ç¨‹ç‹¬ç«‹å¤„ç†ä¸€ä¸ªæ‰¹æ¬¡ï¼š</p>
            
            <div class="code-block">
# ä¸»è¿›ç¨‹åˆ›å»ºä»»åŠ¡é˜Ÿåˆ—
tasks = [
    (0, 30000, 'data/historical', 42),      # æ‰¹æ¬¡0: 3ä¸‡å®¢æˆ·, seed=42
    (1, 30000, 'data/historical', 142),   # æ‰¹æ¬¡1: 3ä¸‡å®¢æˆ·, seed=142
    (2, 30000, 'data/historical', 242),   # æ‰¹æ¬¡2: 3ä¸‡å®¢æˆ·, seed=242
    ...
    (255, 30000, 'data/historical', 25542) # æ‰¹æ¬¡255
]

# æäº¤åˆ°è¿›ç¨‹æ± 
with ProcessPoolExecutor(max_workers=2) as executor:
    futures = {executor.submit(process_batch, task): task[0] 
               for task in tasks}
            </div>
            
            <h3>é˜¶æ®µä¸‰ï¼šå•ä¸ªæ‰¹æ¬¡çš„æ•°æ®ç”Ÿæˆï¼ˆæ ¸å¿ƒé€»è¾‘ï¼‰</h3>
            <p>æ¯ä¸ªå·¥ä½œè¿›ç¨‹æ‰§è¡Œ <code>process_batch()</code> å‡½æ•°ï¼Œç”Ÿæˆä¸€ä¸ªæ‰¹æ¬¡çš„æ•°æ®ï¼š</p>
            
            <div class="flow-diagram" style="margin: 24px 0;">
                <div class="flow-step">
                    <div class="step-number">3.1</div>
                    <div class="step-content">
                        <div class="step-title">ç”Ÿæˆå®¢æˆ·æ•°æ®</div>
                        <div class="step-desc">
                            <strong>generate_customer_batch(batch_id, 30000, seed)</strong><br>
                            - å¾ªç¯ç”Ÿæˆ 30,000 ä¸ªå®¢æˆ·<br>
                            - æ¯ä¸ªå®¢æˆ·åŒ…å« 22 ä¸ªå­—æ®µï¼ˆIDã€ç±»å‹ã€å¹´é¾„ã€æ”¶å…¥ã€èµ„äº§ç­‰ï¼‰<br>
                            - ä½¿ç”¨éšæœºæ•°ç”Ÿæˆå™¨ç¡®ä¿å¯å¤ç°æ€§<br>
                            - è¿”å› DataFrame (30,000 è¡Œ Ã— 22 åˆ—)
                        </div>
                    </div>
                </div>
                
                <div class="flow-step">
                    <div class="step-number">3.2</div>
                    <div class="step-content">
                        <div class="step-title">ç”Ÿæˆè´·æ¬¾ç”³è¯·</div>
                        <div class="step-desc">
                            <strong>generate_loan_applications(customers, batch_id, seed)</strong><br>
                            - éå†æ¯ä¸ªå®¢æˆ·ï¼Œç”Ÿæˆ 8-15 æ¬¡è´·æ¬¾ç”³è¯·ï¼ˆæ³Šæ¾åˆ†å¸ƒï¼‰<br>
                            - è®¡ç®—å®¡æ‰¹æ¦‚ç‡ï¼ˆåŸºäºä¿¡ç”¨è¯„åˆ†ã€è´Ÿå€ºç‡ã€ç»æµå‘¨æœŸï¼‰<br>
                            - å¦‚æœæ‰¹å‡†ï¼Œè®¡ç®—æœˆä¾›å’Œè¿çº¦æ¦‚ç‡<br>
                            - è¿”å› DataFrame (çº¦ 30ä¸‡è¡Œ Ã— 14åˆ—)
                        </div>
                    </div>
                </div>
                
                <div class="flow-step">
                    <div class="step-number">3.3</div>
                    <div class="step-content">
                        <div class="step-title">ç”Ÿæˆè¿˜æ¬¾å†å²</div>
                        <div class="step-desc">
                            <strong>generate_repayment_history(loans, seed)</strong><br>
                            - éå†æ¯ä¸ªå·²æ‰¹å‡†çš„è´·æ¬¾<br>
                            - ä¸ºæ¯ä¸ªè´·æ¬¾ç”Ÿæˆæ¯æœˆè¿˜æ¬¾è®°å½•ï¼ˆterm_months æ¡ï¼‰<br>
                            - æ¨¡æ‹Ÿæ­£å¸¸è¿˜æ¬¾ã€é€¾æœŸã€è¿çº¦ã€æå‰è¿˜æ¬¾ç­‰åœºæ™¯<br>
                            - è¿”å› DataFrame (çº¦ 300ä¸‡è¡Œ Ã— 8åˆ—)
                        </div>
                    </div>
                </div>
                
                <div class="flow-step">
                    <div class="step-number">3.4</div>
                    <div class="step-content">
                        <div class="step-title">ä¿å­˜ä¸´æ—¶æ–‡ä»¶</div>
                        <div class="step-desc">
                            <strong>ä¿å­˜ä¸º Parquet æ ¼å¼</strong><br>
                            - customers.to_parquet('temp/customers_0000.parquet')<br>
                            - loans.to_parquet('temp/loans_0000.parquet')<br>
                            - repayments.to_parquet('temp/repayments_0000.parquet')<br>
                            - æ¯ä¸ªæ–‡ä»¶çº¦ 20-30MBï¼ˆå‹ç¼©åï¼‰
                        </div>
                    </div>
                </div>
            </div>
            
            <h3>é˜¶æ®µå››ï¼šè¿›åº¦ç›‘æ§</h3>
            <p>ä¸»è¿›ç¨‹ç›‘æ§æ‰€æœ‰æ‰¹æ¬¡ä»»åŠ¡çš„å®Œæˆæƒ…å†µï¼š</p>
            <div class="code-block">
# ä½¿ç”¨ as_completed() è·å–å®Œæˆçš„ä»»åŠ¡
for i, future in enumerate(as_completed(futures)):
    result = future.result()  # è·å–æ‰¹æ¬¡ç»“æœ
    total_customers += result['customers']
    total_loans += result['loans']
    total_repayments += result['repayments']
    
    # æ¯å®Œæˆ10ä¸ªæ‰¹æ¬¡ï¼Œæ‰“å°è¿›åº¦
    if (i + 1) % 10 == 0:
        progress = (i + 1) / 256 * 100
        print(f"è¿›åº¦: {progress:.1f}% | å®¢æˆ·: {total_customers:,} | ...")
            </div>
            
            <h3>é˜¶æ®µäº”ï¼šæ•°æ®åˆå¹¶</h3>
            <p>æ‰€æœ‰æ‰¹æ¬¡å®Œæˆåï¼Œåˆå¹¶ä¸´æ—¶æ–‡ä»¶ï¼š</p>
            <div class="code-block">
# 1. æ”¶é›†æ‰€æœ‰ä¸´æ—¶æ–‡ä»¶
customer_files = sorted(glob('temp/customers_*.parquet'))  # 256ä¸ªæ–‡ä»¶
loan_files = sorted(glob('temp/loans_*.parquet'))          # 256ä¸ªæ–‡ä»¶
repayment_files = sorted(glob('temp/repayments_*.parquet')) # 256ä¸ªæ–‡ä»¶

# 2. åˆå¹¶å®¢æˆ·æ•°æ®
customers = pd.concat([
    pd.read_parquet(f) for f in customer_files
], ignore_index=True)
customers.to_parquet('customers.parquet')  # æœ€ç»ˆæ–‡ä»¶ ~350MB

# 3. åˆå¹¶è´·æ¬¾æ•°æ®
loans = pd.concat([
    pd.read_parquet(f) for f in loan_files
], ignore_index=True)
loans.to_parquet('loan_applications.parquet')  # æœ€ç»ˆæ–‡ä»¶ ~1.1GB

# 4. åˆå¹¶è¿˜æ¬¾æ•°æ®ï¼ˆæ•°æ®é‡å¤§ï¼Œåˆ†å—è¯»å–ï¼‰
repayment_chunks = [pd.read_parquet(f) for f in repayment_files]
repayments = pd.concat(repayment_chunks, ignore_index=True)
repayments.to_parquet('repayment_history.parquet')  # æœ€ç»ˆæ–‡ä»¶ ~1.2GB
            </div>
            
            <h3>é˜¶æ®µå…­ï¼šç”Ÿæˆå®è§‚ç»æµæ•°æ®</h3>
            <div class="code-block">
# ç”Ÿæˆ2015-2024å¹´çš„æœˆåº¦å®è§‚ç»æµæ•°æ®
macro = generate_macro_economics()
# åŒ…å«ï¼šGDPå¢é•¿ç‡ã€CPIã€PPIã€å¤±ä¸šç‡ã€åŸºå‡†åˆ©ç‡ã€LPRç­‰
macro.to_parquet('macro_economics.parquet')  # ~17KB
            </div>
            
            <h3>é˜¶æ®µä¸ƒï¼šæ¸…ç†ä¸æ‘˜è¦</h3>
            <div class="code-block">
# 1. åˆ é™¤ä¸´æ—¶æ–‡ä»¶
for f in glob('temp/*.parquet'):
    f.unlink()  # åˆ é™¤256Ã—3=768ä¸ªä¸´æ—¶æ–‡ä»¶
rmdir('temp')

# 2. ç”Ÿæˆæ‘˜è¦æ–‡ä»¶
summary = {
    'generated_at': '2025-12-08T...',
    'total_customers': 7,692,307,
    'total_loans': 19,230,768,
    'total_repayments': 192,307,680,
    'total_size_gb': 9.87,
    'date_range': '2015-01-01 to 2024-12-31'
}
json.dump(summary, open('summary.json', 'w'))
            </div>
            
            <div class="info-box" style="margin-top: 32px;">
                <strong>â±ï¸ æ—¶é—´çº¿ç¤ºä¾‹ï¼ˆ256æ‰¹æ¬¡ï¼Œ2è¿›ç¨‹ï¼‰ï¼š</strong>
                <ul>
                    <li><strong>0-30åˆ†é’Ÿï¼š</strong>å¹¶è¡Œç”Ÿæˆå‰60ä¸ªæ‰¹æ¬¡ï¼Œä¸´æ—¶æ–‡ä»¶ç´¯ç§¯åˆ° ~1.2GB</li>
                    <li><strong>30-60åˆ†é’Ÿï¼š</strong>ç»§ç»­ç”Ÿæˆï¼Œä¸´æ—¶æ–‡ä»¶ç´¯ç§¯åˆ° ~2.5GB</li>
                    <li><strong>60-90åˆ†é’Ÿï¼š</strong>ç»§ç»­ç”Ÿæˆï¼Œä¸´æ—¶æ–‡ä»¶ç´¯ç§¯åˆ° ~3.8GB</li>
                    <li><strong>90-120åˆ†é’Ÿï¼š</strong>å®Œæˆæ‰€æœ‰256ä¸ªæ‰¹æ¬¡ï¼Œä¸´æ—¶æ–‡ä»¶æ€»è®¡ ~5.2GB</li>
                    <li><strong>120-150åˆ†é’Ÿï¼š</strong>åˆå¹¶æ‰€æœ‰ä¸´æ—¶æ–‡ä»¶ï¼Œç”Ÿæˆæœ€ç»ˆæ–‡ä»¶ ~2.65GBï¼ˆå‹ç¼©åï¼‰</li>
                    <li><strong>150åˆ†é’Ÿï¼š</strong>æ¸…ç†å®Œæˆï¼Œæ€»æ•°æ®é‡ ~10GBï¼ˆè§£å‹åçº¦15GBï¼‰</li>
                </ul>
            </div>
        </div>
        
        <!-- æ•´ä½“æ¶æ„ -->
        <div class="section">
            <h2>ğŸ—ï¸ æ•´ä½“æ¶æ„</h2>
            
            <div class="flow-diagram">
                <div class="flow-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <div class="step-title">å¹¶è¡Œæ‰¹æ¬¡ç”Ÿæˆ</div>
                        <div class="step-desc">
                            å°†ç›®æ ‡å®¢æˆ·æ•°ï¼ˆå¦‚770ä¸‡ï¼‰åˆ†å‰²ä¸ºå¤šä¸ªæ‰¹æ¬¡ï¼ˆå¦‚256æ‰¹ï¼Œæ¯æ‰¹3ä¸‡å®¢æˆ·ï¼‰ï¼Œ
                            ä½¿ç”¨å¤šè¿›ç¨‹å¹¶è¡Œç”Ÿæˆï¼Œå……åˆ†åˆ©ç”¨CPUèµ„æº
                        </div>
                    </div>
                </div>
                
                <div class="flow-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <div class="step-title">ä¸´æ—¶æ–‡ä»¶å­˜å‚¨</div>
                        <div class="step-desc">
                            æ¯ä¸ªæ‰¹æ¬¡ç”Ÿæˆçš„æ•°æ®å…ˆä¿å­˜ä¸ºä¸´æ—¶ Parquet æ–‡ä»¶ï¼ˆcustomers_*.parquet, loans_*.parquet, repayments_*.parquetï¼‰ï¼Œ
                            é¿å…å†…å­˜æº¢å‡º
                        </div>
                    </div>
                </div>
                
                <div class="flow-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <div class="step-title">æ•°æ®åˆå¹¶</div>
                        <div class="step-desc">
                            æ‰€æœ‰æ‰¹æ¬¡å®Œæˆåï¼Œä½¿ç”¨ pandas.concat() åˆå¹¶æ‰€æœ‰ä¸´æ—¶æ–‡ä»¶ï¼Œ
                            ç”Ÿæˆæœ€ç»ˆçš„ customers.parquet, loan_applications.parquet, repayment_history.parquet
                        </div>
                    </div>
                </div>
                
                <div class="flow-step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <div class="step-title">æ¸…ç†ä¸æ‘˜è¦</div>
                        <div class="step-desc">
                            åˆ é™¤ä¸´æ—¶æ–‡ä»¶ï¼Œç”Ÿæˆ summary.json æ•°æ®æ‘˜è¦ï¼Œè®¡ç®—æ€»æ•°æ®é‡
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="stat-box">
                <div class="stat-item">
                    <div class="stat-value">770ä¸‡</div>
                    <div class="stat-label">ç›®æ ‡å®¢æˆ·æ•°</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">256</div>
                    <div class="stat-label">å¹¶è¡Œæ‰¹æ¬¡</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">~10GB</div>
                    <div class="stat-label">æœ€ç»ˆæ•°æ®é‡</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">2-4å°æ—¶</div>
                    <div class="stat-label">ç”Ÿæˆè€—æ—¶</div>
                </div>
            </div>
        </div>
        
        <!-- å®¢æˆ·æ•°æ®ç”Ÿæˆ -->
        <div class="section">
            <h2>ğŸ‘¥ å®¢æˆ·æ•°æ®ç”Ÿæˆ (Customers)</h2>
            
            <h3>1. å®¢æˆ·ç±»å‹åˆ†å¸ƒ</h3>
            <p>æ ¹æ®çœŸå®é“¶è¡Œå®¢æˆ·ç»“æ„ï¼Œç”Ÿæˆ4ç§å®¢æˆ·ç±»å‹ï¼š</p>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>å®¢æˆ·ç±»å‹</th>
                        <th>å æ¯”</th>
                        <th>ç‰¹å¾</th>
                        <th>åŸºç¡€è¿çº¦ç‡</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>å·¥è–ªé˜¶å±‚ (salaried)</td>
                        <td>45%</td>
                        <td>æ”¶å…¥ç¨³å®šï¼Œå¹´é¾„35Â±10å²ï¼Œæœˆæ”¶å…¥1.2ä¸‡Â±0.8ä¸‡</td>
                        <td>2%</td>
                    </tr>
                    <tr>
                        <td>å°å¾®ä¼ä¸šä¸» (small_business)</td>
                        <td>25%</td>
                        <td>æ”¶å…¥æ³¢åŠ¨å¤§ï¼Œå¹´é¾„40Â±10å²ï¼Œæœˆæ”¶å…¥2.5ä¸‡Â±2ä¸‡</td>
                        <td>4%</td>
                    </tr>
                    <tr>
                        <td>è‡ªç”±èŒä¸š (freelancer)</td>
                        <td>15%</td>
                        <td>æ”¶å…¥ä¸ç¨³å®šï¼Œå¹´é¾„32Â±8å²ï¼Œæœˆæ”¶å…¥1.5ä¸‡Â±1.2ä¸‡</td>
                        <td>5%</td>
                    </tr>
                    <tr>
                        <td>å†œæˆ· (farmer)</td>
                        <td>15%</td>
                        <td>æ”¶å…¥å­£èŠ‚æ€§ï¼Œå¹´é¾„45Â±12å²ï¼Œæœˆæ”¶å…¥0.6ä¸‡Â±0.4ä¸‡</td>
                        <td>3%</td>
                    </tr>
                </tbody>
            </table>
            
            <h3>2. å®¢æˆ·ç‰¹å¾ç”Ÿæˆé€»è¾‘</h3>
            <div class="code-block">
# å®¢æˆ·IDç”Ÿæˆ
customer_id = f"C{batch_id:04d}{i:06d}"  # ä¾‹å¦‚: C0000123456

# å¹´é¾„ç”Ÿæˆï¼ˆæ­£æ€åˆ†å¸ƒï¼‰
age = int(rng.normal(35, 10))  # å‡å€¼35ï¼Œæ ‡å‡†å·®10
age = max(22, min(65, age))    # é™åˆ¶åœ¨22-65å²

# æ”¶å…¥ç”Ÿæˆï¼ˆæ­£æ€åˆ†å¸ƒï¼‰
monthly_income = max(3000, rng.normal(income_mean, income_std))

# èµ„äº§ç”Ÿæˆ
total_assets = max(10000, rng.normal(asset_mean, asset_std))
debt_ratio = max(0, min(0.9, rng.normal(0.4, 0.15)))  # å¹³å‡è´Ÿå€ºç‡40%
total_liabilities = total_assets * debt_ratio

# ä¿¡ç”¨è¯„åˆ†ï¼ˆæ¨¡æ‹Ÿå¤®è¡Œå¾ä¿¡ï¼‰
credit_score = int(rng.normal(680, 80))  # å‡å€¼680ï¼Œæ ‡å‡†å·®80
credit_score = max(350, min(950, credit_score))  # é™åˆ¶åœ¨350-950
            </div>
            
            <h3>3. ç”Ÿæˆå­—æ®µåˆ—è¡¨</h3>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>å­—æ®µå</th>
                        <th>ç±»å‹</th>
                        <th>è¯´æ˜</th>
                        <th>ç”Ÿæˆæ–¹æ³•</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>customer_id</td>
                        <td>string</td>
                        <td>å®¢æˆ·å”¯ä¸€æ ‡è¯†</td>
                        <td>C + æ‰¹æ¬¡ID + åºå·</td>
                    </tr>
                    <tr>
                        <td>customer_type</td>
                        <td>string</td>
                        <td>å®¢æˆ·ç±»å‹</td>
                        <td>æŒ‰åˆ†å¸ƒæ¦‚ç‡éšæœºé€‰æ‹©</td>
                    </tr>
                    <tr>
                        <td>age</td>
                        <td>int</td>
                        <td>å¹´é¾„</td>
                        <td>æ­£æ€åˆ†å¸ƒï¼Œæ ¹æ®å®¢æˆ·ç±»å‹è°ƒæ•´å‡å€¼</td>
                    </tr>
                    <tr>
                        <td>monthly_income</td>
                        <td>float</td>
                        <td>æœˆæ”¶å…¥</td>
                        <td>æ­£æ€åˆ†å¸ƒï¼Œæœ€å°å€¼3000å…ƒ</td>
                    </tr>
                    <tr>
                        <td>total_assets</td>
                        <td>float</td>
                        <td>æ€»èµ„äº§</td>
                        <td>æ­£æ€åˆ†å¸ƒï¼Œæ ¹æ®å®¢æˆ·ç±»å‹è°ƒæ•´</td>
                    </tr>
                    <tr>
                        <td>debt_ratio</td>
                        <td>float</td>
                        <td>è´Ÿå€ºç‡</td>
                        <td>æ­£æ€åˆ†å¸ƒ(å‡å€¼0.4, æ ‡å‡†å·®0.15)</td>
                    </tr>
                    <tr>
                        <td>credit_score</td>
                        <td>int</td>
                        <td>ä¿¡ç”¨è¯„åˆ†</td>
                        <td>æ­£æ€åˆ†å¸ƒ(å‡å€¼680, æ ‡å‡†å·®80)</td>
                    </tr>
                    <tr>
                        <td>customer_since</td>
                        <td>date</td>
                        <td>æˆä¸ºå®¢æˆ·æ—¶é—´</td>
                        <td>2015-2024å¹´é—´éšæœºï¼Œåå‘å‰80%æ—¶é—´æ®µ</td>
                    </tr>
                    <tr>
                        <td>base_default_rate</td>
                        <td>float</td>
                        <td>åŸºç¡€è¿çº¦ç‡</td>
                        <td>æ ¹æ®å®¢æˆ·ç±»å‹å›ºå®šå€¼(0.02-0.05)</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- è´·æ¬¾ç”³è¯·ç”Ÿæˆ -->
        <div class="section">
            <h2>ğŸ’³ è´·æ¬¾ç”³è¯·ç”Ÿæˆ (Loan Applications)</h2>
            
            <h3>1. ç”³è¯·é¢‘ç‡</h3>
            <p>æ¯ä¸ªå®¢æˆ·åœ¨æˆä¸ºå®¢æˆ·åï¼Œä¼šç”Ÿæˆå¤šæ¬¡è´·æ¬¾ç”³è¯·ï¼š</p>
            <div class="formula">
n_applications = Poisson(Î»=10) + 5  # å¹³å‡æ¯ä¸ªå®¢æˆ·ç”³è¯· 15 æ¬¡è´·æ¬¾
            </div>
            <p style="margin-top: 8px; color: var(--text-muted);">
                ä½¿ç”¨æ³Šæ¾åˆ†å¸ƒæ¨¡æ‹ŸçœŸå®åœºæ™¯ï¼šå¤§éƒ¨åˆ†å®¢æˆ·ç”³è¯·5-20æ¬¡ï¼Œå°‘æ•°å®¢æˆ·ç”³è¯·æ›´å¤šã€‚
            </p>
            
            <h3>2. ç”³è¯·æ—¶é—´åˆ†å¸ƒ</h3>
            <p>ç”³è¯·æ—¶é—´åœ¨"æˆä¸ºå®¢æˆ·æ—¶é—´"åˆ°"æ•°æ®ç»“æŸæ—¶é—´"ä¹‹é—´å‡åŒ€åˆ†å¸ƒï¼š</p>
            <div class="code-block">
customer_since = datetime(2015-01-01 ~ 2024-12-31)  # å®¢æˆ·æ³¨å†Œæ—¶é—´
available_days = (END_DATE - customer_since).days   # å¯ç”³è¯·å¤©æ•°
apply_date = customer_since + random(30, available_days)  # ç”³è¯·æ—¥æœŸ
            </div>
            
            <h3>3. è´·æ¬¾é‡‘é¢è®¡ç®—</h3>
            <p>è´·æ¬¾é‡‘é¢å—å®¢æˆ·æ”¶å…¥å’Œèµ„äº§é™åˆ¶ï¼š</p>
            <div class="formula">
max_amount = min(monthly_income Ã— 36, total_assets Ã— 0.5)
loan_amount = uniform(10,000, max_amount)
            </div>
            
            <h3>4. åˆ©ç‡å®šä»·æ¨¡å‹</h3>
            <p>åˆ©ç‡ç”±ä¸‰éƒ¨åˆ†ç»„æˆï¼šåŸºå‡†åˆ©ç‡ + é£é™©æº¢ä»· + éšæœºè°ƒæ•´</p>
            <div class="code-block">
# åŸºå‡†åˆ©ç‡ï¼ˆå—ç»æµå‘¨æœŸå½±å“ï¼‰
base_rate = 0.04  # æ­£å¸¸æœŸ
if eco_phase == 'depression':
    base_rate = 0.06  # è§æ¡æœŸæé«˜

# é£é™©æº¢ä»·ï¼ˆåŸºäºä¿¡ç”¨è¯„åˆ†ï¼‰
risk_premium = (1 - credit_score / 950) Ã— 0.08

# æœ€ç»ˆåˆ©ç‡
interest_rate = base_rate + risk_premium + random(-0.005, 0.01)
interest_rate = clamp(0.04, 0.24)  # é™åˆ¶åœ¨4%-24%
            </div>
            
            <h3>5. å®¡æ‰¹å†³ç­–æ¨¡å‹</h3>
            <p>å®¡æ‰¹é€šè¿‡æ¦‚ç‡å—å¤šä¸ªå› ç´ å½±å“ï¼š</p>
            <div class="formula">
approval_prob = 0.7 Ã— (credit_score / 700) Ã— (1 - debt_ratio) Ã— eco_factor

# ç»æµå‘¨æœŸå½±å“
if eco_phase == 'depression':
    eco_factor = 0.7  # è§æ¡æœŸæ”¶ç´§å®¡æ‰¹
else:
    eco_factor = 1.0

approved = random() < approval_prob
            </div>
            
            <h3>6. è¿çº¦æ¦‚ç‡è®¡ç®—</h3>
            <p>å¦‚æœè´·æ¬¾è·æ‰¹ï¼Œè®¡ç®—è¿çº¦æ¦‚ç‡ï¼ˆç”¨äºåç»­è¿˜æ¬¾æ¨¡æ‹Ÿï¼‰ï¼š</p>
            <div class="code-block">
default_prob = base_default_rate

# ç»æµå‘¨æœŸå½±å“ï¼ˆå…³é”®ï¼ï¼‰
if eco_phase == 'depression':
    default_prob Ã—= 2.5  # è§æ¡æœŸè¿çº¦ç‡æé«˜2.5å€
elif eco_phase == 'recession':
    default_prob Ã—= 1.5
elif eco_phase == 'boom':
    default_prob Ã—= 0.7  # ç¹è£æœŸé™ä½

# è´Ÿå€ºç‡å½±å“
if debt_ratio > 0.6:
    default_prob Ã—= 2.0  # é«˜è´Ÿå€ºç‡é£é™©ç¿»å€
elif debt_ratio > 0.4:
    default_prob Ã—= 1.3

# æœˆä¾›å æ”¶å…¥æ¯”
payment_ratio = monthly_payment / monthly_income
if payment_ratio > 0.5:
    default_prob Ã—= 2.5  # æœˆä¾›è¶…è¿‡æ”¶å…¥50%é£é™©æé«˜

# ä¿¡ç”¨è¯„åˆ†å½±å“
default_prob Ã—= (1.5 - credit_score / 950)

default_prob = clamp(0.001, 0.8)  # é™åˆ¶åœ¨0.1%-80%
defaulted = random() < default_prob
            </div>
            
            <div class="info">
                <strong>ğŸ’¡ å…³é”®è®¾è®¡ï¼š</strong>è¿çº¦æ¦‚ç‡çš„è®¡ç®—ä½“ç°äº†çœŸå®é‡‘èä¸šåŠ¡ä¸­çš„é£é™©å åŠ æ•ˆåº”ã€‚
                ç»æµå‘¨æœŸã€è´Ÿå€ºç‡ã€æœˆä¾›å‹åŠ›ã€ä¿¡ç”¨è¯„åˆ†ç­‰å¤šä¸ªå› ç´ å…±åŒä½œç”¨ï¼Œå½¢æˆå¤æ‚çš„é£é™©æ¨¡å‹ã€‚
            </div>
        </div>
        
        <!-- è¿˜æ¬¾å†å²ç”Ÿæˆ -->
        <div class="section">
            <h2>ğŸ’° è¿˜æ¬¾å†å²ç”Ÿæˆ (Repayment History)</h2>
            
            <h3>1. è¿˜æ¬¾è®°å½•ç”Ÿæˆ</h3>
            <p>å¯¹äºæ¯ç¬”è·æ‰¹çš„è´·æ¬¾ï¼Œç”Ÿæˆæ¯æœˆè¿˜æ¬¾è®°å½•ï¼š</p>
            <div class="code-block">
for month in range(1, term_months + 1):
    due_date = apply_date + timedelta(days=30 Ã— month)
    
    # åˆ¤æ–­è¿˜æ¬¾çŠ¶æ€
    if loan['defaulted'] and month >= default_month:
        payment_status = 'defaulted'  # å·²è¿çº¦ï¼Œä¸å†è¿˜æ¬¾
        actual_payment = 0
    elif loan['prepaid'] and month > term_months Ã— 0.6:
        payment_status = 'prepaid'  # æå‰è¿˜æ¬¾
        actual_payment = remaining_balance
    else:
        # æ­£å¸¸è¿˜æ¬¾ï¼Œä½†æœ‰2%æ¦‚ç‡é€¾æœŸ
        if random() < 0.02:
            dpd = exponential(7)  # é€¾æœŸå¤©æ•°ï¼ˆæŒ‡æ•°åˆ†å¸ƒï¼‰
            payment_status = 'late'
        else:
            dpd = 0
            payment_status = 'on_time'
        
        actual_payment = monthly_payment
            </div>
            
            <h3>2. è¿˜æ¬¾çŠ¶æ€ç±»å‹</h3>
            <table class="data-table">
                <thead>
                    <tr>
                        <th>çŠ¶æ€</th>
                        <th>è¯´æ˜</th>
                        <th>è§¦å‘æ¡ä»¶</th>
                        <th>å æ¯”</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>on_time</td>
                        <td>æŒ‰æ—¶è¿˜æ¬¾</td>
                        <td>æ­£å¸¸æƒ…å†µ</td>
                        <td>~88%</td>
                    </tr>
                    <tr>
                        <td>late</td>
                        <td>é€¾æœŸè¿˜æ¬¾</td>
                        <td>2%æ¦‚ç‡ï¼Œé€¾æœŸå¤©æ•°æŒ‡æ•°åˆ†å¸ƒ</td>
                        <td>~2%</td>
                    </tr>
                    <tr>
                        <td>defaulted</td>
                        <td>è¿çº¦</td>
                        <td>æ ¹æ®è¿çº¦æ¦‚ç‡è®¡ç®—</td>
                        <td>~8%</td>
                    </tr>
                    <tr>
                        <td>prepaid</td>
                        <td>æå‰è¿˜æ¬¾</td>
                        <td>10%æ¦‚ç‡ï¼Œè¿˜æ¬¾æœŸè¶…è¿‡60%å</td>
                        <td>~2%</td>
                    </tr>
                </tbody>
            </table>
            
            <h3>3. æ•°æ®é‡ä¼°ç®—</h3>
            <div class="stat-box">
                <div class="stat-item">
                    <div class="stat-value">770ä¸‡</div>
                    <div class="stat-label">å®¢æˆ·æ•°</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">1.15äº¿</div>
                    <div class="stat-label">è´·æ¬¾ç”³è¯·ï¼ˆå¹³å‡15æ¬¡/å®¢æˆ·ï¼‰</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">~3äº¿</div>
                    <div class="stat-label">è¿˜æ¬¾è®°å½•ï¼ˆå¹³å‡24ä¸ªæœˆ/è´·æ¬¾ï¼‰</div>
                </div>
                <div class="stat-item">
                    <div class="stat-value">~10GB</div>
                    <div class="stat-label">æ€»æ•°æ®é‡</div>
                </div>
            </div>
        </div>
        
        <!-- ç»æµå‘¨æœŸæ¨¡æ‹Ÿ -->
        <div class="section">
            <h2>ğŸŒŠ ç»æµå‘¨æœŸæ¨¡æ‹Ÿ</h2>
            
            <p>æ•°æ®ç”Ÿæˆè¿‡ç¨‹ä¸­ï¼Œæ¯ä¸ªè´·æ¬¾ç”³è¯·éƒ½ä¼šæ ¹æ®ç”³è¯·æ—¶é—´ç¡®å®šå½“æ—¶çš„ç»æµå‘¨æœŸï¼š</p>
            
            <table class="data-table">
                <thead>
                    <tr>
                        <th>æ—¶é—´æ®µ</th>
                        <th>å‘¨æœŸé˜¶æ®µ</th>
                        <th>GDPå¢é•¿ç‡</th>
                        <th>å¤±ä¸šç‡</th>
                        <th>å¯¹è¿çº¦ç‡å½±å“</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td>2015-2016</td>
                        <td>ç¹è£æœŸ (boom)</td>
                        <td>6%-8%</td>
                        <td>4%-5%</td>
                        <td>Ã—0.7ï¼ˆé™ä½30%ï¼‰</td>
                    </tr>
                    <tr>
                        <td>2017-2018</td>
                        <td>æ­£å¸¸æœŸ (normal)</td>
                        <td>4%-6%</td>
                        <td>5%-6%</td>
                        <td>Ã—1.0ï¼ˆæ— å½±å“ï¼‰</td>
                    </tr>
                    <tr>
                        <td>2019</td>
                        <td>è¡°é€€æœŸ (recession)</td>
                        <td>2%-4%</td>
                        <td>6%-7%</td>
                        <td>Ã—1.5ï¼ˆæé«˜50%ï¼‰</td>
                    </tr>
                    <tr>
                        <td>2020</td>
                        <td>è§æ¡æœŸ (depression)</td>
                        <td>-2%-2%</td>
                        <td>8%-12%</td>
                        <td>Ã—2.5ï¼ˆæé«˜150%ï¼‰</td>
                    </tr>
                    <tr>
                        <td>2021-2022</td>
                        <td>å¤è‹æœŸ (recovery)</td>
                        <td>3%-5%</td>
                        <td>5%-7%</td>
                        <td>Ã—1.0ï¼ˆé€æ­¥æ¢å¤ï¼‰</td>
                    </tr>
                    <tr>
                        <td>2023-2024</td>
                        <td>æ­£å¸¸æœŸ (normal)</td>
                        <td>3%-5%</td>
                        <td>5%-6%</td>
                        <td>Ã—1.0ï¼ˆç¨³å®šï¼‰</td>
                    </tr>
                </tbody>
            </table>
            
            <div class="warning">
                <strong>âš ï¸ å…³é”®è®¾è®¡ï¼š</strong>ç»æµå‘¨æœŸå¯¹è¿çº¦ç‡çš„å½±å“æ˜¯æ•°æ®ç”Ÿæˆçš„æ ¸å¿ƒé€»è¾‘ä¹‹ä¸€ã€‚
                2020å¹´ï¼ˆCOVID-19ï¼‰çš„è§æ¡æœŸä¼šå¯¼è‡´è¯¥å¹´ç”³è¯·çš„è´·æ¬¾è¿çº¦ç‡æ˜¾è‘—æé«˜ï¼Œ
                è¿™åæ˜ äº†çœŸå®é‡‘èä¸šåŠ¡ä¸­å®è§‚ç»æµå¯¹ä¿¡è´·é£é™©çš„é‡è¦å½±å“ã€‚
            </div>
        </div>
        
        <!-- å¹¶è¡Œå¤„ç†æœºåˆ¶ -->
        <div class="section">
            <h2>âš¡ å¹¶è¡Œå¤„ç†æœºåˆ¶</h2>
            
            <h3>1. æ‰¹æ¬¡åˆ†å‰²</h3>
            <div class="code-block">
total_customers = 7,692,307  # ç›®æ ‡å®¢æˆ·æ•°
batch_size = 30,000          # æ¯æ‰¹å®¢æˆ·æ•°
n_batches = 256              # æ€»æ‰¹æ¬¡æ•°

# åˆ›å»ºæ‰¹æ¬¡ä»»åŠ¡
tasks = [
    (batch_id, batch_size, output_dir, seed)
    for batch_id in range(n_batches)
]
            </div>
            
            <h3>2. å¤šè¿›ç¨‹æ‰§è¡Œ</h3>
            <div class="code-block">
from concurrent.futures import ProcessPoolExecutor

n_workers = 2  # å¹¶è¡Œè¿›ç¨‹æ•°ï¼ˆå»ºè®®ä¸ºCPUæ ¸å¿ƒæ•°ï¼‰

with ProcessPoolExecutor(max_workers=n_workers) as executor:
    # æäº¤æ‰€æœ‰æ‰¹æ¬¡ä»»åŠ¡
    futures = {
        executor.submit(process_batch, task): task[0] 
        for task in tasks
    }
    
    # æ”¶é›†ç»“æœ
    for future in as_completed(futures):
        result = future.result()
        # æ›´æ–°è¿›åº¦...
            </div>
            
            <h3>3. å†…å­˜ä¼˜åŒ–</h3>
            <ul>
                <li><strong>åˆ†æ‰¹ç”Ÿæˆï¼š</strong>æ¯æ‰¹åªå¤„ç†3ä¸‡å®¢æˆ·ï¼Œé¿å…å†…å­˜æº¢å‡º</li>
                <li><strong>ä¸´æ—¶æ–‡ä»¶ï¼š</strong>æ¯æ‰¹æ•°æ®ç«‹å³å†™å…¥Parquetæ–‡ä»¶ï¼Œé‡Šæ”¾å†…å­˜</li>
                <li><strong>å»¶è¿Ÿåˆå¹¶ï¼š</strong>æ‰€æœ‰æ‰¹æ¬¡å®Œæˆåå†åˆå¹¶ï¼Œé¿å…å†…å­˜å³°å€¼</li>
                <li><strong>åˆ†å—è¯»å–ï¼š</strong>åˆå¹¶å¤§æ–‡ä»¶æ—¶ä½¿ç”¨åˆ†å—è¯»å–ï¼Œæ§åˆ¶å†…å­˜ä½¿ç”¨</li>
            </ul>
        </div>
        
        <!-- æ•°æ®åˆå¹¶æµç¨‹ -->
        <div class="section">
            <h2>ğŸ”„ æ•°æ®åˆå¹¶æµç¨‹</h2>
            
            <div class="flow-diagram">
                <div class="flow-step">
                    <div class="step-number">1</div>
                    <div class="step-content">
                        <div class="step-title">æ”¶é›†ä¸´æ—¶æ–‡ä»¶</div>
                        <div class="step-desc">
                            æ‰«æ temp/ ç›®å½•ï¼Œæ‰¾åˆ°æ‰€æœ‰ customers_*.parquet, loans_*.parquet, repayments_*.parquet æ–‡ä»¶
                        </div>
                    </div>
                </div>
                
                <div class="flow-step">
                    <div class="step-number">2</div>
                    <div class="step-content">
                        <div class="step-title">åˆ†è¡¨åˆå¹¶</div>
                        <div class="step-desc">
                            åˆ†åˆ«åˆå¹¶å®¢æˆ·ã€è´·æ¬¾ã€è¿˜æ¬¾ä¸‰ç±»æ•°æ®ï¼š
                            <div class="code-block" style="margin-top: 8px;">
customers = pd.concat([pd.read_parquet(f) for f in customer_files])
loans = pd.concat([pd.read_parquet(f) for f in loan_files])
repayments = pd.concat([pd.read_parquet(f) for f in repayment_files])
                            </div>
                        </div>
                    </div>
                </div>
                
                <div class="flow-step">
                    <div class="step-number">3</div>
                    <div class="step-content">
                        <div class="step-title">ä¿å­˜æœ€ç»ˆæ–‡ä»¶</div>
                        <div class="step-desc">
                            ä¿å­˜ä¸º customers.parquet, loan_applications.parquet, repayment_history.parquet
                        </div>
                    </div>
                </div>
                
                <div class="flow-step">
                    <div class="step-number">4</div>
                    <div class="step-content">
                        <div class="step-title">ç”Ÿæˆå®è§‚ç»æµæ•°æ®</div>
                        <div class="step-desc">
                            ç”Ÿæˆ2015-2024å¹´æ¯æœˆå®è§‚ç»æµæŒ‡æ ‡ï¼ˆGDPã€CPIã€å¤±ä¸šç‡ã€åˆ©ç‡ç­‰ï¼‰
                        </div>
                    </div>
                </div>
                
                <div class="flow-step">
                    <div class="step-number">5</div>
                    <div class="step-content">
                        <div class="step-title">æ¸…ç†ä¸æ‘˜è¦</div>
                        <div class="step-desc">
                            åˆ é™¤æ‰€æœ‰ä¸´æ—¶æ–‡ä»¶ï¼Œç”Ÿæˆ summary.json åŒ…å«æ•°æ®ç»Ÿè®¡ä¿¡æ¯
                        </div>
                    </div>
                </div>
            </div>
        </div>
        
        <!-- æ•°æ®è´¨é‡ä¿è¯ -->
        <div class="section">
            <h2>âœ… æ•°æ®è´¨é‡ä¿è¯</h2>
            
            <h3>1. æ•°æ®ä¸€è‡´æ€§</h3>
            <ul>
                <li><strong>å®¢æˆ·IDå”¯ä¸€æ€§ï¼š</strong>ä½¿ç”¨æ‰¹æ¬¡ID+åºå·ç¡®ä¿å…¨å±€å”¯ä¸€</li>
                <li><strong>æ—¶é—´é€»è¾‘ï¼š</strong>è´·æ¬¾ç”³è¯·æ—¶é—´å¿…é¡»åœ¨å®¢æˆ·æ³¨å†Œæ—¶é—´ä¹‹å</li>
                <li><strong>è¿˜æ¬¾å…³è”ï¼š</strong>æ¯ç¬”è¿˜æ¬¾è®°å½•éƒ½å…³è”åˆ°æœ‰æ•ˆçš„è´·æ¬¾ç”³è¯·</li>
                <li><strong>é‡‘é¢åˆç†æ€§ï¼š</strong>è´·æ¬¾é‡‘é¢ä¸è¶…è¿‡å®¢æˆ·æ”¶å…¥Ã—36æˆ–èµ„äº§Ã—0.5</li>
            </ul>
            
            <h3>2. åˆ†å¸ƒåˆç†æ€§</h3>
            <ul>
                <li><strong>å®¢æˆ·ç±»å‹åˆ†å¸ƒï¼š</strong>ç¬¦åˆçœŸå®é“¶è¡Œå®¢æˆ·ç»“æ„ï¼ˆå·¥è–ª45%ï¼Œå°å¾®25%ç­‰ï¼‰</li>
                <li><strong>è¿çº¦ç‡åˆ†å¸ƒï¼š</strong>æ•´ä½“è¿çº¦ç‡çº¦8-12%ï¼Œç¬¦åˆè¡Œä¸šå¹³å‡æ°´å¹³</li>
                <li><strong>ç»æµå‘¨æœŸå½±å“ï¼š</strong>2020å¹´è¿çº¦ç‡æ˜æ˜¾æé«˜ï¼Œä½“ç°COVIDå½±å“</li>
                <li><strong>ä¿¡ç”¨è¯„åˆ†åˆ†å¸ƒï¼š</strong>æ­£æ€åˆ†å¸ƒï¼Œå‡å€¼680ï¼Œç¬¦åˆå¤®è¡Œå¾ä¿¡åˆ†å¸ƒ</li>
            </ul>
            
            <h3>3. æ•°æ®å®Œæ•´æ€§</h3>
            <ul>
                <li><strong>å­—æ®µå®Œæ•´æ€§ï¼š</strong>æ‰€æœ‰å¿…éœ€å­—æ®µéƒ½æœ‰å€¼ï¼Œæ— ç¼ºå¤±</li>
                <li><strong>æ•°æ®ç±»å‹ï¼š</strong>ä¸¥æ ¼æŒ‰ç…§Parquet Schemaå®šä¹‰</li>
                <li><strong>æ—¶é—´èŒƒå›´ï¼š</strong>æ‰€æœ‰æ•°æ®éƒ½åœ¨2015-01-01åˆ°2024-12-31èŒƒå›´å†…</li>
            </ul>
        </div>
        
        <!-- ä½¿ç”¨ç¤ºä¾‹ -->
        <div class="section">
            <h2>ğŸ’» ä½¿ç”¨ç¤ºä¾‹</h2>
            
            <h3>ç”Ÿæˆæ•°æ®</h3>
            <div class="code-block">
# ç”Ÿæˆ10GBæ•°æ®
python3 scripts/generate_dataset.py \
    --output data/historical \
    --target-size 10 \
    --batch-size 30000 \
    --workers 2

# å¿«é€Ÿæµ‹è¯•ï¼ˆç”Ÿæˆ1ä¸‡å®¢æˆ·ï¼‰
python3 scripts/generate_dataset.py --quick

# è‡ªå®šä¹‰å®¢æˆ·æ•°
python3 scripts/generate_dataset.py \
    --customers 5000000 \
    --batch-size 20000
            </div>
            
            <h3>åŠ è½½æ•°æ®</h3>
            <div class="code-block">
import pandas as pd

# åŠ è½½å®¢æˆ·æ•°æ®
customers = pd.read_parquet('data/historical/customers.parquet')
print(f"å®¢æˆ·æ•°: {len(customers):,}")

# åŠ è½½è´·æ¬¾ç”³è¯·
loans = pd.read_parquet('data/historical/loan_applications.parquet')
print(f"è´·æ¬¾ç”³è¯·: {len(loans):,}")

# åŠ è½½è¿˜æ¬¾å†å²
repayments = pd.read_parquet('data/historical/repayment_history.parquet')
print(f"è¿˜æ¬¾è®°å½•: {len(repayments):,}")

# æŸ¥çœ‹æ•°æ®æ‘˜è¦
import json
with open('data/historical/summary.json') as f:
    summary = json.load(f)
    print(json.dumps(summary, indent=2, ensure_ascii=False))
            </div>
        </div>
        
        <!-- Parquet æ ¼å¼è¯¦è§£ -->
        <div class="section">
            <h2>ğŸ“¦ Parquet æ–‡ä»¶æ ¼å¼è¯¦è§£</h2>
            
            <h3>1. ä»€ä¹ˆæ˜¯ Parquetï¼Ÿ</h3>
            <p>
                <strong>Apache Parquet</strong> æ˜¯ä¸€ç§å¼€æºçš„åˆ—å¼å­˜å‚¨æ–‡ä»¶æ ¼å¼ï¼Œä¸“ä¸ºå¤§æ•°æ®åˆ†æè®¾è®¡ã€‚
                å®ƒç”± Twitter å’Œ Cloudera å…±åŒå¼€å‘ï¼Œç°å·²æˆä¸ºå¤§æ•°æ®ç”Ÿæ€ç³»ç»Ÿçš„æ ‡å‡†æ ¼å¼ä¹‹ä¸€ã€‚
            </p>
            
            <div class="info-box">
                <strong>ğŸ’¡ æ ¸å¿ƒç‰¹ç‚¹ï¼š</strong>
                <ul>
                    <li><strong>åˆ—å¼å­˜å‚¨ï¼š</strong>æŒ‰åˆ—ç»„ç»‡æ•°æ®ï¼Œè€ŒéæŒ‰è¡Œï¼Œé€‚åˆåˆ†ææŸ¥è¯¢</li>
                    <li><strong>é«˜æ•ˆå‹ç¼©ï¼š</strong>ç›¸åŒç±»å‹æ•°æ®å‹ç¼©ç‡é«˜ï¼Œå¯èŠ‚çœ50-90%å­˜å‚¨ç©ºé—´</li>
                    <li><strong>å¿«é€ŸæŸ¥è¯¢ï¼š</strong>åªè¯»å–éœ€è¦çš„åˆ—ï¼Œå¤§å¹…å‡å°‘I/O</li>
                    <li><strong>Schema å†…åµŒï¼š</strong>æ–‡ä»¶åŒ…å«å®Œæ•´çš„å…ƒæ•°æ®ï¼Œæ— éœ€é¢å¤–å®šä¹‰</li>
                    <li><strong>è·¨å¹³å°ï¼š</strong>æ”¯æŒ Pythonã€Javaã€C++ã€R ç­‰å¤šç§è¯­è¨€</li>
                </ul>
            </div>
            
            <h3>2. Parquet æ–‡ä»¶ç»“æ„</h3>
            
            <div class="code-block">
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                    Parquet æ–‡ä»¶ç»“æ„                      â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  File Header (Magic Number: "PAR1")             â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Row Group 1 (è¡Œç»„1)                              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚  â”‚
â”‚  â”‚  â”‚ Column Chunk â”‚  â”‚ Column Chunk â”‚  ...         â”‚  â”‚
â”‚  â”‚  â”‚ (customer_id)â”‚  â”‚ (age)        â”‚              â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Row Group 2 (è¡Œç»„2)                              â”‚  â”‚
â”‚  â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”              â”‚  â”‚
â”‚  â”‚  â”‚ Column Chunk â”‚  â”‚ Column Chunk â”‚  ...         â”‚  â”‚
â”‚  â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜              â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â”‚  ... (æ›´å¤šè¡Œç»„) ...                                     â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  File Footer (å…ƒæ•°æ®)                             â”‚  â”‚
â”‚  â”‚  - Schema å®šä¹‰                                    â”‚  â”‚
â”‚  â”‚  - è¡Œç»„ä½ç½®ç´¢å¼•                                   â”‚  â”‚
â”‚  â”‚  - ç»Ÿè®¡ä¿¡æ¯ (min/max/null count)                 â”‚  â”‚
â”‚  â”‚  - å‹ç¼©ä¿¡æ¯                                       â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â”‚                                                         â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”‚
â”‚  â”‚  Footer Length (4 bytes)                          â”‚  â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
            </div>
            
            <h3>3. åˆ—å¼å­˜å‚¨ vs è¡Œå¼å­˜å‚¨</h3>
            
            <div style="display: grid; grid-template-columns: 1fr 1fr; gap: 24px; margin: 24px 0;">
                <div style="background: rgba(239, 68, 68, 0.1); padding: 20px; border-radius: 12px; border: 1px solid rgba(239, 68, 68, 0.3);">
                    <h4 style="color: #EF4444; margin-bottom: 12px;">âŒ è¡Œå¼å­˜å‚¨ (CSV/JSON)</h4>
                    <div class="code-block" style="font-size: 11px; margin: 12px 0;">
Row 1: C001, 35, M, 12000, 300000, 0.4, ...
Row 2: C002, 28, F, 8000, 150000, 0.3, ...
Row 3: C003, 42, M, 25000, 800000, 0.5, ...
                    </div>
                    <ul style="font-size: 0.9rem; color: var(--text-muted);">
                        <li>æŸ¥è¯¢æ‰€æœ‰è¡Œçš„ age åˆ—ï¼šéœ€è¦è¯»å–æ•´è¡Œ</li>
                        <li>å‹ç¼©ç‡ä½ï¼šä¸åŒç±»å‹æ•°æ®æ··åˆ</li>
                        <li>é€‚åˆï¼šäº‹åŠ¡å¤„ç†ã€éšæœºè®¿é—®</li>
                    </ul>
                </div>
                
                <div style="background: rgba(0, 212, 170, 0.1); padding: 20px; border-radius: 12px; border: 1px solid rgba(0, 212, 170, 0.3);">
                    <h4 style="color: var(--accent); margin-bottom: 12px;">âœ… åˆ—å¼å­˜å‚¨ (Parquet)</h4>
                    <div class="code-block" style="font-size: 11px; margin: 12px 0;">
customer_id: [C001, C002, C003, ...]
age:        [35, 28, 42, ...]
gender:     [M, F, M, ...]
income:     [12000, 8000, 25000, ...]
                    </div>
                    <ul style="font-size: 0.9rem; color: var(--text-muted);">
                        <li>æŸ¥è¯¢æ‰€æœ‰è¡Œçš„ age åˆ—ï¼šåªè¯»å– age åˆ—</li>
                        <li>å‹ç¼©ç‡é«˜ï¼šç›¸åŒç±»å‹æ•°æ®è¿ç»­å­˜å‚¨</li>
                        <li>é€‚åˆï¼šæ•°æ®åˆ†æã€èšåˆæŸ¥è¯¢</li>
                    </ul>
                </div>
            </div>
            
            <h3>4. Parquet æ–‡ä»¶ç»„æˆè¦ç´ </h3>
            
            <h4>4.1 Schemaï¼ˆæ¨¡å¼å®šä¹‰ï¼‰</h4>
            <p>Parquet æ–‡ä»¶å†…åµŒå®Œæ•´çš„ Schema ä¿¡æ¯ï¼ŒåŒ…æ‹¬ï¼š</p>
            <ul>
                <li><strong>å­—æ®µåï¼š</strong>æ¯ä¸ªåˆ—çš„åç§°</li>
                <li><strong>æ•°æ®ç±»å‹ï¼š</strong>INT64, DOUBLE, STRING, BOOLEAN ç­‰</li>
                <li><strong>å¯é€‰æ€§ï¼š</strong>å­—æ®µæ˜¯å¦å…è®¸ NULL</li>
                <li><strong>åµŒå¥—ç»“æ„ï¼š</strong>æ”¯æŒå¤æ‚ç±»å‹ï¼ˆSTRUCT, ARRAY, MAPï¼‰</li>
            </ul>
            
            <div class="code-block">
# ç¤ºä¾‹ï¼šcustomers.parquet çš„ Schema
message customers {
  required binary customer_id (UTF8);
  required binary customer_type (UTF8);
  required int64 age;
  required binary gender (UTF8);
  required double monthly_income;
  required double total_assets;
  required double debt_ratio;
  required boolean has_house;
  required int64 credit_score;
  ...
}
            </div>
            
            <h4>4.2 Row Groupï¼ˆè¡Œç»„ï¼‰</h4>
            <p>
                è¡Œç»„æ˜¯ Parquet æ–‡ä»¶çš„åŸºæœ¬å­˜å‚¨å•å…ƒï¼Œæ¯ä¸ªè¡Œç»„åŒ…å«ï¼š
            </p>
            <ul>
                <li><strong>Column Chunksï¼š</strong>æ¯ä¸ªåˆ—çš„æ•°æ®å—</li>
                <li><strong>é¡µï¼ˆPagesï¼‰ï¼š</strong>åˆ—å—è¿›ä¸€æ­¥åˆ†ä¸ºé¡µï¼Œä¾¿äºå‹ç¼©å’Œè¯»å–</li>
                <li><strong>ç»Ÿè®¡ä¿¡æ¯ï¼š</strong>æ¯ä¸ªè¡Œç»„åŒ…å«è¯¥ç»„æ•°æ®çš„ min/max/null count</li>
            </ul>
            
            <div class="info-box">
                <strong>ğŸ’¡ è¡Œç»„å¤§å°ä¼˜åŒ–ï¼š</strong>
                <ul>
                    <li>é»˜è®¤è¡Œç»„å¤§å°ï¼š128MBï¼ˆå¯é…ç½®ï¼‰</li>
                    <li>è¾ƒå¤§è¡Œç»„ï¼šå‹ç¼©ç‡æ›´é«˜ï¼Œä½†è¯»å–æ—¶éœ€è¦æ›´å¤šå†…å­˜</li>
                    <li>è¾ƒå°è¡Œç»„ï¼šè¯»å–æ›´å¿«ï¼Œä½†å‹ç¼©ç‡ç•¥ä½</li>
                </ul>
            </div>
            
            <h4>4.3 å‹ç¼©ç®—æ³•</h4>
            <p>Parquet æ”¯æŒå¤šç§å‹ç¼©ç®—æ³•ï¼š</p>
            <table style="width: 100%; margin: 16px 0; border-collapse: collapse;">
                <thead>
                    <tr style="background: rgba(0, 102, 255, 0.1);">
                        <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">ç®—æ³•</th>
                        <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">å‹ç¼©ç‡</th>
                        <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">é€Ÿåº¦</th>
                        <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">é»˜è®¤</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);"><code>UNCOMPRESSED</code></td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">0%</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">æœ€å¿«</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">âŒ</td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);"><code>SNAPPY</code></td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">ä¸­ç­‰ (~50%)</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">å¿«</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">âœ… Pandasé»˜è®¤</td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);"><code>GZIP</code></td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">é«˜ (~70%)</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">ä¸­ç­‰</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">âœ… æ¨è</td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);"><code>BROTLI</code></td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">æœ€é«˜ (~80%)</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">æ…¢</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">âŒ</td>
                    </tr>
                </tbody>
            </table>
            
            <h3>5. Gamium æ•°æ®é›†çš„ Parquet ç»“æ„</h3>
            
            <h4>5.1 customers.parquet</h4>
            <div class="code-block">
# å®¢æˆ·æ•°æ®è¡¨ç»“æ„
Schema:
  - customer_id: STRING (ä¸»é”®)
  - customer_type: STRING (salaried/small_business/freelancer/farmer)
  - age: INT64
  - gender: STRING (M/F)
  - city_tier: STRING (tier_1/tier_2/tier_3/tier_4)
  - province: STRING
  - industry: STRING
  - education: STRING
  - marital_status: STRING
  - years_employed: DOUBLE
  - monthly_income: DOUBLE
  - income_volatility: DOUBLE
  - total_assets: DOUBLE
  - total_liabilities: DOUBLE
  - debt_ratio: DOUBLE
  - deposit_balance: DOUBLE
  - deposit_stability: DOUBLE
  - has_house: BOOLEAN
  - has_car: BOOLEAN
  - credit_score: INT64
  - customer_since: STRING (YYYY-MM-DD)
  - base_default_rate: DOUBLE

æ–‡ä»¶å¤§å°: ~350MB (500ä¸‡å®¢æˆ·)
å‹ç¼©ç‡: ~60% (ç›¸æ¯”CSV)
            </div>
            
            <h4>5.2 loan_applications.parquet</h4>
            <div class="code-block">
# è´·æ¬¾ç”³è¯·æ•°æ®è¡¨ç»“æ„
Schema:
  - application_id: STRING (ä¸»é”®)
  - customer_id: STRING (å¤–é”® â†’ customers.customer_id)
  - apply_date: STRING (YYYY-MM-DD)
  - loan_amount: DOUBLE
  - term_months: INT64
  - interest_rate: DOUBLE
  - purpose: STRING
  - approved: BOOLEAN
  - monthly_payment: DOUBLE
  - loan_status: STRING (completed/defaulted/prepaid/rejected)
  - default_month: INT64 (nullable)
  - max_dpd: INT64
  - eco_phase: STRING
  - gdp_growth: DOUBLE
  - unemployment_rate: DOUBLE

æ–‡ä»¶å¤§å°: ~1.1GB (çº¦2000ä¸‡è´·æ¬¾ç”³è¯·)
å‹ç¼©ç‡: ~65%
            </div>
            
            <h4>5.3 repayment_history.parquet</h4>
            <div class="code-block">
# è¿˜æ¬¾å†å²æ•°æ®è¡¨ç»“æ„
Schema:
  - repayment_id: STRING (ä¸»é”®)
  - application_id: STRING (å¤–é”® â†’ loan_applications.application_id)
  - customer_id: STRING (å¤–é”® â†’ customers.customer_id)
  - due_date: STRING (YYYY-MM-DD)
  - due_amount: DOUBLE
  - actual_payment: DOUBLE
  - payment_date: STRING (nullable, YYYY-MM-DD)
  - dpd: INT64 (Days Past Due)
  - payment_status: STRING (on_time/late/defaulted/prepaid)

æ–‡ä»¶å¤§å°: ~1.2GB (çº¦1äº¿æ¡è¿˜æ¬¾è®°å½•)
å‹ç¼©ç‡: ~70%
            </div>
            
            <h3>6. Parquet çš„ä¼˜åŠ¿ï¼ˆä¸ºä»€ä¹ˆé€‰æ‹© Parquetï¼Ÿï¼‰</h3>
            
            <div style="display: grid; grid-template-columns: repeat(2, 1fr); gap: 16px; margin: 24px 0;">
                <div style="background: rgba(0, 102, 255, 0.1); padding: 16px; border-radius: 8px;">
                    <strong style="color: var(--accent);">ğŸ“Š å­˜å‚¨æ•ˆç‡</strong>
                    <p style="font-size: 0.9rem; color: var(--text-muted); margin-top: 8px;">
                        ç›¸æ¯” CSVï¼ŒParquet å¯èŠ‚çœ 50-90% å­˜å‚¨ç©ºé—´ã€‚
                        10GB CSV æ•°æ®å¯èƒ½åªéœ€ 2-3GB Parquetã€‚
                    </p>
                </div>
                
                <div style="background: rgba(0, 212, 170, 0.1); padding: 16px; border-radius: 8px;">
                    <strong style="color: var(--accent);">âš¡ æŸ¥è¯¢é€Ÿåº¦</strong>
                    <p style="font-size: 0.9rem; color: var(--text-muted); margin-top: 8px;">
                        åˆ—å¼å­˜å‚¨ + ç»Ÿè®¡ä¿¡æ¯ï¼ŒèšåˆæŸ¥è¯¢é€Ÿåº¦æå‡ 10-100 å€ã€‚
                        åªè¯»å–éœ€è¦çš„åˆ—ï¼Œå¤§å¹…å‡å°‘ I/Oã€‚
                    </p>
                </div>
                
                <div style="background: rgba(255, 184, 0, 0.1); padding: 16px; border-radius: 8px;">
                    <strong style="color: var(--gold);">ğŸ” Schema å†…åµŒ</strong>
                    <p style="font-size: 0.9rem; color: var(--text-muted); margin-top: 8px;">
                        æ–‡ä»¶è‡ªå¸¦å®Œæ•´ Schemaï¼Œæ— éœ€é¢å¤–å®šä¹‰ã€‚
                        æ”¯æŒç±»å‹æ£€æŸ¥ï¼Œé¿å…æ•°æ®é”™è¯¯ã€‚
                    </p>
                </div>
                
                <div style="background: rgba(236, 72, 153, 0.1); padding: 16px; border-radius: 8px;">
                    <strong style="color: #EC4899;">ğŸŒ è·¨å¹³å°</strong>
                    <p style="font-size: 0.9rem; color: var(--text-muted); margin-top: 8px;">
                        Pythonã€Javaã€Sparkã€Pandasã€DuckDB ç­‰å¹¿æ³›æ”¯æŒã€‚
                        å¤§æ•°æ®ç”Ÿæ€ç³»ç»Ÿçš„æ ‡å‡†æ ¼å¼ã€‚
                    </p>
                </div>
            </div>
            
            <h3>7. å¦‚ä½•æŸ¥çœ‹ Parquet æ–‡ä»¶ä¿¡æ¯ï¼Ÿ</h3>
            
            <div class="code-block">
# Python æ–¹å¼
import pandas as pd
import pyarrow.parquet as pq

# è¯»å– Parquet æ–‡ä»¶
df = pd.read_parquet('data/historical/customers.parquet')

# æŸ¥çœ‹ Schema
parquet_file = pq.ParquetFile('data/historical/customers.parquet')
print(parquet_file.schema)

# æŸ¥çœ‹å…ƒæ•°æ®
print(parquet_file.metadata)

# æŸ¥çœ‹è¡Œç»„ä¿¡æ¯
print(f"è¡Œç»„æ•°: {parquet_file.num_row_groups}")
for i in range(parquet_file.num_row_groups):
    row_group = parquet_file.metadata.row_group(i)
    print(f"è¡Œç»„ {i}: {row_group.num_rows} è¡Œ")

# æŸ¥çœ‹ç»Ÿè®¡ä¿¡æ¯
for i in range(parquet_file.num_row_groups):
    stats = parquet_file.metadata.row_group(i).column(0).statistics
    print(f"customer_id min: {stats.min}, max: {stats.max}")
            </div>
            
            <div class="code-block">
# å‘½ä»¤è¡Œæ–¹å¼ï¼ˆä½¿ç”¨ parquet-toolsï¼‰
# å®‰è£…: pip install parquet-tools

# æŸ¥çœ‹æ–‡ä»¶ä¿¡æ¯
parquet-tools meta data/historical/customers.parquet

# æŸ¥çœ‹ Schema
parquet-tools schema data/historical/customers.parquet

# æŸ¥çœ‹å‰å‡ è¡Œ
parquet-tools head data/historical/customers.parquet -n 10
            </div>
            
            <h3>8. Parquet æ–‡ä»¶çš„å®é™…å­˜å‚¨ç¤ºä¾‹</h3>
            
            <div class="info-box">
                <strong>ğŸ“ æ–‡ä»¶ç³»ç»Ÿè§†å›¾ï¼š</strong>
                <div class="code-block" style="font-size: 12px;">
data/historical/
â”œâ”€â”€ customers.parquet          (350 MB)
â”‚   â”œâ”€â”€ File Header: "PAR1"
â”‚   â”œâ”€â”€ Row Group 0 (100ä¸‡è¡Œ)
â”‚   â”‚   â”œâ”€â”€ customer_id column chunk (å‹ç¼©å)
â”‚   â”‚   â”œâ”€â”€ age column chunk (å‹ç¼©å)
â”‚   â”‚   â”œâ”€â”€ monthly_income column chunk (å‹ç¼©å)
â”‚   â”‚   â””â”€â”€ ... (å…¶ä»–22åˆ—)
â”‚   â”œâ”€â”€ Row Group 1 (100ä¸‡è¡Œ)
â”‚   â”œâ”€â”€ ...
â”‚   â”œâ”€â”€ Row Group 4 (100ä¸‡è¡Œ)
â”‚   â””â”€â”€ File Footer (Schema + ç´¢å¼•)
â”‚
â”œâ”€â”€ loan_applications.parquet (1.1 GB)
â”‚   â””â”€â”€ ... (ç±»ä¼¼ç»“æ„)
â”‚
â”œâ”€â”€ repayment_history.parquet (1.2 GB)
â”‚   â””â”€â”€ ... (ç±»ä¼¼ç»“æ„)
â”‚
â””â”€â”€ macro_economics.parquet   (17 KB)
                </div>
            </div>
            
            <h3>9. æ•°æ®ç”Ÿæˆè¿‡ç¨‹ä¸­çš„ Parquet å†™å…¥</h3>
            
            <div class="code-block">
# åœ¨ generate_dataset.py ä¸­çš„å†™å…¥è¿‡ç¨‹

# 1. ç”Ÿæˆ DataFrame
customers = pd.DataFrame([...])  # Python å­—å…¸åˆ—è¡¨

# 2. è½¬æ¢ä¸º Parquet
customers.to_parquet(
    'customers.parquet',
    index=False,              # ä¸ä¿å­˜è¡Œç´¢å¼•
    compression='snappy',     # ä½¿ç”¨ SNAPPY å‹ç¼©
    engine='pyarrow'          # ä½¿ç”¨ PyArrow å¼•æ“
)

# 3. PyArrow å†…éƒ¨å¤„ç†ï¼š
#    - æ¨æ–­ Schemaï¼ˆä» DataFrame ç±»å‹ï¼‰
#    - å°†æ•°æ®æŒ‰åˆ—ç»„ç»‡
#    - åº”ç”¨å‹ç¼©ç®—æ³•
#    - ç”Ÿæˆè¡Œç»„ï¼ˆé»˜è®¤128MBï¼‰
#    - è®¡ç®—ç»Ÿè®¡ä¿¡æ¯ï¼ˆmin/max/null countï¼‰
#    - å†™å…¥æ–‡ä»¶ + Footer
            </div>
            
            <h3>10. æ€§èƒ½å¯¹æ¯”ï¼šParquet vs CSV</h3>
            
            <table style="width: 100%; margin: 24px 0; border-collapse: collapse;">
                <thead>
                    <tr style="background: rgba(0, 102, 255, 0.1);">
                        <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">æŒ‡æ ‡</th>
                        <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">CSV</th>
                        <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">Parquet</th>
                        <th style="padding: 12px; text-align: left; border-bottom: 1px solid rgba(255,255,255,0.1);">æå‡</th>
                    </tr>
                </thead>
                <tbody>
                    <tr>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">æ–‡ä»¶å¤§å° (500ä¸‡å®¢æˆ·)</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">~850 MB</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">~350 MB</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05); color: var(--accent);">59% â†“</td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">è¯»å–é€Ÿåº¦ (å…¨è¡¨)</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">~15 ç§’</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">~3 ç§’</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05); color: var(--accent);">5x â†‘</td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">è¯»å–å•åˆ— (age)</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">~15 ç§’</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">~0.5 ç§’</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05); color: var(--accent);">30x â†‘</td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">èšåˆæŸ¥è¯¢ (AVG income)</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">~12 ç§’</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">~0.8 ç§’</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05); color: var(--accent);">15x â†‘</td>
                    </tr>
                    <tr>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">Schema æ”¯æŒ</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">âŒ æ— </td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05);">âœ… å®Œæ•´</td>
                        <td style="padding: 12px; border-bottom: 1px solid rgba(255,255,255,0.05); color: var(--accent);">ç±»å‹å®‰å…¨</td>
                    </tr>
                </tbody>
            </table>
        </div>
        
        <!-- æ€§èƒ½ä¼˜åŒ–å»ºè®® -->
        <div class="section">
            <h2>ğŸš€ æ€§èƒ½ä¼˜åŒ–å»ºè®®</h2>
            
            <h3>1. å¹¶è¡Œåº¦è°ƒæ•´</h3>
            <ul>
                <li><strong>CPUæ ¸å¿ƒæ•°ï¼š</strong>workers è®¾ç½®ä¸º CPUæ ¸å¿ƒæ•°ï¼Œå……åˆ†åˆ©ç”¨å¤šæ ¸</li>
                <li><strong>å†…å­˜é™åˆ¶ï¼š</strong>å¦‚æœå†…å­˜ä¸è¶³ï¼Œå‡å°‘ workers æˆ– batch_size</li>
                <li><strong>æ‰¹æ¬¡å¤§å°ï¼š</strong>batch_size å»ºè®®åœ¨ 20000-50000 ä¹‹é—´ï¼Œå¹³è¡¡å†…å­˜å’Œæ•ˆç‡</li>
            </ul>
            
            <h3>2. å­˜å‚¨ä¼˜åŒ–</h3>
            <ul>
                <li><strong>Parquetæ ¼å¼ï¼š</strong>ä½¿ç”¨åˆ—å¼å­˜å‚¨ï¼Œå‹ç¼©ç‡é«˜ï¼Œè¯»å–å¿«</li>
                <li><strong>ä¸´æ—¶ç›®å½•ï¼š</strong>ç¡®ä¿æœ‰è¶³å¤Ÿç£ç›˜ç©ºé—´ï¼ˆå»ºè®®è‡³å°‘15GBï¼‰</li>
                <li><strong>SSDä¼˜å…ˆï¼š</strong>å¦‚æœå¯èƒ½ï¼Œå°†æ•°æ®ç”Ÿæˆåˆ°SSDä¸Šï¼Œé€Ÿåº¦æ›´å¿«</li>
            </ul>
            
            <h3>3. ç›‘æ§ä¸è°ƒè¯•</h3>
            <ul>
                <li><strong>è¿›åº¦ç›‘æ§ï¼š</strong>ä½¿ç”¨ check_progress.sh è„šæœ¬æŸ¥çœ‹å®æ—¶è¿›åº¦</li>
                <li><strong>æ—¥å¿—æŸ¥çœ‹ï¼š</strong>tail -f data_generation.log æŸ¥çœ‹è¯¦ç»†æ—¥å¿—</li>
                <li><strong>å†…å­˜ç›‘æ§ï¼š</strong>ä½¿ç”¨ htop æˆ– Activity Monitor ç›‘æ§å†…å­˜ä½¿ç”¨</li>
            </ul>
        </div>
        
        <div style="text-align: center; margin-top: 48px; padding: 32px; background: rgba(0, 102, 255, 0.1); border-radius: 16px;">
            <p style="color: var(--text-muted); margin-bottom: 16px;">
                æœ¬æ–‡æ¡£è¯¦ç»†æè¿°äº† Gamium æ•°æ®ç”Ÿæˆçš„å®Œæ•´æµç¨‹
            </p>
            <p style="font-size: 0.9rem; color: var(--text-muted);">
                å¦‚æœ‰ç–‘é—®ï¼Œè¯·æŸ¥çœ‹æºä»£ç ï¼š<code>scripts/generate_dataset.py</code>
            </p>
        </div>
    </div>
</body>
</html>

